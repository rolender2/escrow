# User Guide: Repair Escrow Automation MVP

Welcome to the **"Repair Closer"** prototype. This tool allows Real Estate Agents to save deals by automating post-closing repair holdbacks.

## 1. Quick Start
Ensure all systems are running:
*   **Database**: PostgreSQL (`escrow_db`)
*   **Backend**: `http://localhost:8000` (API)
*   **Frontend**: `http://localhost:3000` (Dashboard)

## 2. The Workflow
This MVP simulates a real-world scenario where a roof needs repair *after* closing.

### Step 1: Agent Creates the Holdback
1.  Go to the **Dashboard**: [http://localhost:3000](http://localhost:3000)
2.  Click **"+ New Repair Escrow"**.
3.  Fill in the deal details:
    *   **Buyer**: "Alice Buyer"
    *   **Contractor**: "Bob's Roofing"
    *   **Amount**: `5000`
    *   **Repair Item**: "Roof Repair"
4.  Click **Create & Lock Funds**.
    *   *System Action*: Creates an Escrow record and sets status to `PENDING`.

### Step 2: Contractor Uploads Evidence
1.  Click on the new Escrow card in the Dashboard.
2.  In the "Required Evidence" section, you see "Photo" is required.
3.  (Simulate Upload): Enter a fake URL (e.g., `http://cloud/roof_done.jpg`) and click **"Upload"**.
    *   *Status Change*: Milestone updates to `EVIDENCE_SUBMITTED`.

### Step 3: Inspector Approves Release
1.  Once evidence is uploaded, the **"Approve Release"** button appears (green).
2.  (Simulate Inspector): Click **"Approve Release"**.
    *   *System Action*: Verifies evidence exists.
    *   *System Action*: Digitally signs the approval.
    *   *System Action*: Generates a JSON **Banking Instruction** to wire funds to the Contractor.

### Step 4: Verification
To see the "Banking Instruction" generated by the Rule Engine:
1.  Go to the API Docs: [http://localhost:8000/docs](http://localhost:8000/docs)
2.  Use the `GET /escrows/{id}/instruction/{milestone_id}` endpoint.
3.  Or, simply check the UI stateâ€”if it says **"Funds Released"**, the instruction was successfully generated.

## 3. Troubleshooting
*   **Dashboard Empty?** Ensure the backend is running (`uvicorn ...`). Check browser console for CORS errors.
*   **Upload Failed?** Ensure you are entering a non-empty string for the URL.
*   **Approve Failed?** You cannot approve until *all* required evidence types (e.g., "Photo") have been uploaded.
